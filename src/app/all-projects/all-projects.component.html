<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="searchCustomer">
            <div class="nameCard">
                <div class="title-heading">
                    <h5> Search Customer</h5>
                </div>
                <form [formGroup]="searchForm" (ngSubmit)="searchCustomer()">
                    <input type="text" formControlName="mobile" placeholder="Enter Mobile No/ Name">
                    <button class="btn btn-primary" type="submit"> Search</button>
                </form>
            </div> 
            <hr>
            <div *ngIf="customers.length > 0">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">No.</th>
                            <th scope="col">Client Code</th>
                            <th scope="col">Client Name</th>
                            <th scope="col">Mobile Number</th>
                            <th scope="col">Project Category</th>
                            <th scope="col">Closing Date</th>
                            <th scope="col">Closing Payment</th>
                            <th scope="col">Amount Received</th>
                            <th scope="col">Remaining Amount</th>
                            <th scope="col">Project Status</th>
                            <th scope="col">Sales Person</th>
                            <th scope="col">View</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let customer of customers; let i = index">
                            <td>{{i+1}}</td>
                            <td>{{customer.custCode}}</td>
                            <td>{{customer.custName}}</td>
                            <td>{{customer.custNumb}}</td>
                            <td>{{customer.closingCateg}}</td>
                            <td>{{customer.closingDate}}</td>
                            <td>{{customer.closingPrice}}</td>
                            <td>{{customer.AdvPay}}</td>
                            <td>{{customer.remainingAmount}}</td>
                            <td>{{customer.projectStatus}}</td>
                            <td>{{customer.salesPerson}}</td>
                            <td>
                                <div class="buttons">
                                    <button class="btn btn-sm btn-primary" routerLink="/update-panel/{{customer._id}}"> View</button>   
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="allCustomers">
            <div class="nameCard2">
                <div class="ProjectCard">  
                    <h5>Get Data</h5>
                </div>
                <form [formGroup]="dateRangeForm" (ngSubmit)="onDate()" class="search-Form">
                    <div class="searchData">
                        <!--<div class="nameCard2">
                            <div class="ProjectCard">
                                <h4>Search Data</h4>
                            </div>
                        </div>-->
                        <div class="details">
                            <label for="startDate"> Start Date</label>
                            <input type="date" formControlName="startDate" id="startDate">
                        </div>
                        <div class="details">
                            <label for="endDate"> End Date</label>
                            <input type="date" formControlName="endDate" id="endDate">
                        </div>
                        <div class="details">
                            <button type="submit" class="btn btn-primary"> Submit</button>
                        </div>
                    </div>
                </form>  
            </div>
            <hr>
            <div class="rangeData">
                <div class="downloadButton" *ngIf="rangeData">
                    <button class="btn btn-sm btn-success" (click)="downloadRangeFile()"> Download Data File </button>
                </div>
                <div class="table-scroll" *ngIf="rangeData">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">No.</th>
                                <th scope="col">Client Code</th>
                                <th scope="col">Client Name</th>
                                <th scope="col">Mobile Number</th>
                                <th scope="col">Client Business</th>
                                <th scope="col">Project Category</th>
                                <th scope="col">Closing Date</th>
                                <th scope="col">Closing Payment</th>
                                <th scope="col">Amount Received</th>
                                <th scope="col">Remaining Amount</th>
                                <th scope="col">Project Status</th>
                                <th scope="col">View</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let user of rangeData; let i = index">
                                <td>{{i+1}}</td>
                                <td>{{user.custCode}}</td>
                                <td>{{user.custName}}</td>
                                <td>{{user.custNumb}}</td>
                                <td>{{user.custBussiness}}</td>
                                <td>{{user.closingCateg}}</td>
                                <td>{{user.closingDate}}</td>
                                <td>{{user.closingPrice}}</td>
                                <td>{{user.AdvPay}}</td>
                                <td>{{user.remainingAmount}}</td>
                                <td>{{user.projectStatus}}</td>
                                <td>
                                    <div class="buttons">
                                        <button class="btn btn-sm btn-primary" routerLink="/update-panel/{{user._id}}"> View</button>   
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div> 

<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="allCustomers">
            <div class="nameCard2">
                <div class="ProjectCard"> 
                    <h5>All Projects</h5>
                </div>
                <div class="custom-file-upload">
                    <h6 for="fileInput"> Select File to Upload</h6>
                    <input id="fileInput" type="file" #fileInput (change)="uploadFile($event)">
                    <button class="btn btn-sm btn-primary" (click)="selectFile()"> Upload File </button>
                </div>
            </div> 
            <hr>
            <div class="downloadFile">
                <button class="btn btn-sm btn-success" (click)="downloadFile()"> Download File </button>
            </div>
        </div>
    </div>
</div>

 <div class="row">
    <div class="col-lg-12">
        <p class="d-line-flex gap-1">
            <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#previousTwoMonth" aria-controls="collapseExample">
                {{previousTwoMonthName}}
            </button>
            <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#previousMonth" aria-controls="collapseExample">
                {{previousMonthName}}
            </button>
            <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#currentMonth" aria-controls="collapseExample">
                {{currentMonthName}}
            </button>
        </p>
        <div class="collapse" id="currentMonth">
            <div class="table-scroll">
                <div class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th scope="col">No.</th>
                            <th scope="col">Client Code</th>
                            <th scope="col">Client Name</th>
                            <th scope="col">Mobile Number</th>
                            <th scope="col">Client Business</th>
                            <th scope="col">Project Category</th>
                            <th scope="col">Closing Date</th>
                            <th scope="col">Closing Payment</th>
                            <th scope="col">Amount Received</th>
                            <th scope="col">Remaining Amount</th>
                            <th scope="col">Sales Person</th>
                            <th scope="col">Project Status</th>
                            <th scope="col">Select T.M</th>
                            <th scope="col">T.M Status</th>
                            <!-- <th scope="col">Pass Date</th> -->
                            <th scope="col">View</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of data; let i = index" [class.highlighted]="selectedRowIndex === i">
                            <td>{{i+1}}</td>
                            <td>{{user.custCode}}</td>
                            <td>{{user.custName}}</td>
                            <td>{{user.custNumb}}</td>
                            <td>{{user.custBussiness}}</td>
                            <td>{{user.closingCateg}}</td>
                            <td>{{user.closingDate}}</td>
                            <td>{{user.closingPrice}}</td>
                            <td>{{user.AdvPay}}</td>
                            <td>{{user.remainingAmount}}</td>
                            <td>{{user.salesPerson}}</td>
                            <td>
                                <select [(ngModel)]="user.projectStatus" (change)="updateEditorVisible = (user.projectStatus === 'closing'); updateEditors(user); highlightRow(i)">
                                    <option value="Not Interested">Not Interested</option>
                                    <option value="Interested">Interested</option>
                                    <option value="Closing">Closing</option>
                                    <option value="Scripting">Scripting</option>
                                    <option value="Script Correction">Script Correction</option>
                                    <option value="Voice Over">Voice Over</option>
                                    <option value="Video Editing">Video Editing</option>
                                    <option value="Video Changes">Video Changes</option> 
                                    <option value="Video Done">Video Done</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </td>
                            <td>
                                <select *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Scripting')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Video Editing')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Voice Over')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                            </td>
                            <td *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter">
                                {{user.scriptStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor">
                                {{user.editorStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver">
                                {{user.voiceOverStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Closing' || user.projectStatus === 'Completed'">
                                {{user.projectStatus}}
                            </td>
                            
                            <td>
                                <div class="buttons">
                                    <button class="btn btn-sm btn-primary" routerLink="/update-panel/{{user._id}}"> View</button>   
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </div>
            </div>
        </div>
        <div class="collapse" id="previousMonth">
            <div class="table-scroll">
                <div class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th scope="col">No.</th>
                            <th scope="col">Client Code</th>
                            <th scope="col">Client Name</th>
                            <th scope="col">Mobile Number</th>
                            <th scope="col">Client Business</th>
                            <th scope="col">Project Category</th>
                            <th scope="col">Closing Date</th>
                            <th scope="col">Closing Payment</th>
                            <th scope="col">Amount Received</th>
                            <th scope="col">Remaining Amount</th>
                            <th scope="col">Sales Person</th>
                            <th scope="col">Project Status</th>
                            <th scope="col">Select T.M</th>
                            <th scope="col">T.M Status</th>
                            <!-- <th scope="col">Pass Date</th> -->
                            <th scope="col">View</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of Previousdata; let i = index" [class.highlighted]="selectedRowIndex === i">
                            <td>{{i+1}}</td>
                            <td>{{user.custCode}}</td>
                            <td>{{user.custName}}</td>
                            <td>{{user.custNumb}}</td>
                            <td>{{user.custBussiness}}</td>
                            <td>{{user.closingCateg}}</td>
                            <td>{{user.closingDate}}</td>
                            <td>{{user.closingPrice}}</td>
                            <td>{{user.AdvPay}}</td>
                            <td>{{user.remainingAmount}}</td>
                            <td>{{user.salesPerson}}</td>
                            <td>
                                <select [(ngModel)]="user.projectStatus" (change)="updateEditorVisible = (user.projectStatus === 'closing'); updateEditors(user); highlightRow(i)">
                                    <option value="Not Interested">Not Interested</option>
                                    <option value="Interested">Interested</option>
                                    <option value="Closing">Closing</option>
                                    <option value="Scripting">Scripting</option>
                                    <option value="Script Correction">Script Correction</option>
                                    <option value="Voice Over">Voice Over</option>
                                    <option value="Video Editing">Video Editing</option>
                                    <option value="Video Changes">Video Changes</option> 
                                    <option value="Video Done">Video Done</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </td>
                            <td>
                                <select *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Scripting')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Video Editing')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Voice Over')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                            </td>
                            <td *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter">
                                {{user.scriptStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor">
                                {{user.editorStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver">
                                {{user.voiceOverStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Closing' || user.projectStatus === 'Completed'">
                                {{user.projectStatus}}
                            </td>
                            
                            <td>
                                <div class="buttons">
                                    <button class="btn btn-sm btn-primary" routerLink="/update-panel/{{user._id}}"> View</button>   
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </div>
            </div>
        </div>
        <div class="collapse" id="previousTwoMonth">
            <div class="table-scroll">
                <div class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th scope="col">No.</th>
                            <th scope="col">Client Code</th>
                            <th scope="col">Client Name</th>
                            <th scope="col">Mobile Number</th>
                            <th scope="col">Client Business</th>
                            <th scope="col">Project Category</th>
                            <th scope="col">Closing Date</th>
                            <th scope="col">Closing Payment</th>
                            <th scope="col">Amount Received</th>
                            <th scope="col">Remaining Amount</th>
                            <th scope="col">Sales Person</th>
                            <th scope="col">Project Status</th>
                            <th scope="col">Select T.M</th>
                            <th scope="col">T.M Status</th>
                            <!-- <th scope="col">Pass Date</th> -->
                            <th scope="col">View</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let user of TwoPreviousdata; let i = index" [class.highlighted]="selectedRowIndex === i">
                            <td>{{i+1}}</td>
                            <td>{{user.custCode}}</td>
                            <td>{{user.custName}}</td>
                            <td>{{user.custNumb}}</td>
                            <td>{{user.custBussiness}}</td>
                            <td>{{user.closingCateg}}</td>
                            <td>{{user.closingDate}}</td>
                            <td>{{user.closingPrice}}</td>
                            <td>{{user.AdvPay}}</td>
                            <td>{{user.remainingAmount}}</td>
                            <td>{{user.salesPerson}}</td>
                            <td>
                                <select [(ngModel)]="user.projectStatus" (change)="updateEditorVisible = (user.projectStatus === 'closing'); updateEditors(user); highlightRow(i)">
                                    <option value="Not Interested">Not Interested</option>
                                    <option value="Interested">Interested</option>
                                    <option value="Closing">Closing</option>
                                    <option value="Scripting">Scripting</option>
                                    <option value="Script Correction">Script Correction</option>
                                    <option value="Voice Over">Voice Over</option>
                                    <option value="Video Editing">Video Editing</option>
                                    <option value="Video Changes">Video Changes</option> 
                                    <option value="Video Done">Video Done</option>
                                    <option value="Completed">Completed</option>
                                </select>
                            </td>
                            <td>
                                <select *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Scripting')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Video Editing')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                                <select *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver" (change)="updateEditors(user)">
                                    <option value="none">None</option>
                                    <option *ngFor="let employee of filterEmployeesByRole('Voice Over')" [value]="employee.signupUsername">
                                        {{employee.signupUsername}}
                                    </option>
                                </select>
                            </td>
                            <td *ngIf="user.projectStatus === 'Scripting' || user.projectStatus === 'Script Correction'" [(ngModel)]="user.scriptWriter">
                                {{user.scriptStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Video Editing' || user.projectStatus === 'Video Changes' || user.projectStatus === 'Video Done' " [(ngModel)]="user.editor">
                                {{user.editorStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Voice Over'" [(ngModel)]="user.voiceOver">
                                {{user.voiceOverStatus}}
                            </td>
                            <td *ngIf="user.projectStatus === 'Closing' || user.projectStatus === 'Completed'">
                                {{user.projectStatus}}
                            </td>
                            
                            <td>
                                <div class="buttons">
                                    <button class="btn btn-sm btn-primary" routerLink="/update-panel/{{user._id}}"> View</button>   
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </div>
            </div>
        </div>
    </div>
 </div>